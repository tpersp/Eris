# Eris – Modular Digital Signage Platform  
*Controlled chaos for beautiful screens.*

Eris is a lightweight Linux-based digital signage system that displays web pages, videos, and images on connected monitors.  
It’s built for Raspberry Pi Zero 2 W, Pi 4 B, and Ubuntu Server devices.

## Hardware & software requirements

- Raspberry Pi Zero 2 W (512 MB RAM min) or Pi 4 B (2 GB + recommended)
- Micro-SD (16 GB +)
- HDMI display
- Fresh OS (Lite or Server)
- Network access (Wi-Fi or Ethernet)

## Quick install commands

```bash
# Quick install (one-liner)
curl -fsSL https://raw.githubusercontent.com/tpersp/Eris/main/setup.sh | sudo bash

# Manual install route
# 1. Download the installer
git clone https://github.com/tpersp/Eris.git
cd Eris

# 2. Run interactive setup
chmod +x setup.sh
sudo bash setup.sh
```

The interactive installer will:
- Detect the device type (Pi Zero 2 W, Pi 4 B, or generic Linux)
- Install Chromium, mpv, imv, ffmpeg, Python, and supporting dependencies
- Install Node.js/npm when missing and build the Eris web control UI
- Create the `/opt/eris` virtual environment and Python requirements
- Offer to mount an optional Samba media share for network media
- Configure `/etc/eris/config.yaml` with device, media, security, and scheduler settings
- Generate a secure API token secret and hash the admin password
- Configure and enable the `eris.service` systemd unit
- Print the local access URL when setup completes

## Configuration

Configuration lives under `/etc/eris/`:

```
/etc/eris/config.yaml
/etc/eris/chromium-flags.conf
```

Example `config.yaml` generated by the installer:

```yaml
device:
  name: eris-mydevice
  homepage: "https://example.com"
display:
  name: ":0"
  launcher: "/usr/bin/xinit /opt/eris/scripts/kiosk-session.sh -- :0 -nolisten tcp"
  startup_timeout: 15
ui:
  port: 8080
media:
  use_network: false
  network_path: ""
  mount_point: "/var/lib/eris/media/local"
  local_path: "/var/lib/eris/media/local"
  cache_path: "/var/lib/eris/media/cache"
  metadata_path: "/var/lib/eris/media/metadata.json"
  mpv_binary: "mpv"
  imv_binary: "imv"
  image_duration: 30
  max_upload_mb: 200
state:
  path: "/var/lib/eris/state.json"
  playlist_path: "/var/lib/eris/playlists.json"
security:
  password_hash: "<bcrypt hash>"
  token_secret: "<random secret>"
  token_ttl: 3600
chromium:
  binary: "/usr/bin/chromium-browser"
  flags_file: "/etc/eris/chromium-flags.conf"
  debug_port: 9222
scheduler:
  tick_interval: 15
```

Chromium launch flags live in `/etc/eris/chromium-flags.conf`. Device-specific flags are written automatically (for example `--use-gl=egl` on Raspberry Pi).

## Service control

```bash
sudo systemctl status eris
sudo systemctl restart eris
sudo journalctl -u eris -f
```

## Testing the installation

```bash
curl http://localhost:8080/api/health
```

The API should return JSON containing uptime information. When you browse to `http://<device-ip>:8080/`, the dashboard prompts for the administrator password you provided during installation. After signing in you can:

- Monitor device health, Chromium status, and active playback
- Upload, tag, and delete media in the local library
- Create playlists and time-based schedules
- Configure fallback behaviour for offline scenarios

## Dashboard overview

- **Dashboard** — live metrics (uptime, CPU, memory, temperature) and direct Chromium controls (navigate, reload, back/forward, blank the display).
- **Media Library** — upload assets, manage tags, and remove unused files. Uploaded items live under `/var/lib/eris/media` and become available for playlists immediately.
- **Scheduling** — build playlists from media items, assign them to daypart schedules, and configure fallback behaviour (URL or playlist) when no schedule is active.
- **Security** — every API call and WebSocket connection requires the admin password. Tokens are signed with the secret stored in `config.yaml`.

## Updating or uninstalling

Helper scripts live in `scripts/`:

- `scripts/update.sh` pulls the repository, refreshes Python packages inside `/opt/eris/venv`, and restarts the service.
- `scripts/uninstall.sh` stops Eris, removes installed files, and cleans up the systemd unit.

Run them with:

```bash
sudo bash scripts/update.sh
sudo bash scripts/uninstall.sh
```

## Troubleshooting

| Symptom | Fix |
| --- | --- |
| Black screen | Check HDMI connection and Chromium flags in `/etc/eris/chromium-flags.conf` |
| Web UI unreachable | Confirm port 8080 is open (`curl localhost:8080`) and the service is running |
| Login fails immediately | Ensure the admin password hash exists in `/etc/eris/config.yaml` and restart `eris.service` |
| Media uploads fail | Confirm available disk space and that `/var/lib/eris/media` is writable |
| Samba share not mounting | Verify the `/etc/fstab` entry and run `sudo mount -a` |
| Daemon crash | Inspect logs with `journalctl -u eris -f` |

## Security note

Set a strong admin password during installation, keep devices on trusted networks, and avoid exposing Eris directly to the public Internet without firewalls or an HTTPS reverse proxy. Pair new controllers through the web UI to ensure only authorized users manage the displays.

**Developer note:** Rebuild the web UI manually with:

```bash
cd /opt/eris/apps/webui
npm install
npm run build
```
